<div class="doctors-container">
  <div class="page-header">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h1>Manage Doctors</h1>
        <p class="text-muted">View, edit, and manage all doctors</p>
      </div>
      <button class="btn btn-primary" (click)="openCreateModal()">
        <i class="fas fa-plus me-2"></i>Add Doctor
      </button>
    </div>
  </div>

  <!-- Doctors Table -->
  <div class="row g-4 mt-3">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <div class="d-flex justify-content-between align-items-center">
            <h5>Doctors List</h5>
            <span class="text-muted">{{ doctors.length }} doctor(s) found</span>
          </div>
        </div>
        <div class="card-body">
          @if (loading) {
            <div class="text-center py-4">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p class="mt-2">Loading doctors...</p>
            </div>
          } @else if (!doctors || doctors.length === 0) {
            <div class="empty-state">
              <i class="fas fa-user-md"></i>
              <h4>No doctors found</h4>
              <p>Click "Add Doctor" to create a new doctor</p>
            </div>
          } @else {
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Specialty</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  @for (doctor of doctors; track doctor.id) {
                    <tr>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="doctor-avatar">
                            <i class="fas fa-user-md"></i>
                          </div>
                          <span class="ms-2 fw-bold">{{ doctor.name }}</span>
                        </div>
                      </td>
                      <td>{{ doctor.email }}</td>
                      <td>
                        <span class="badge bg-info">{{ doctor.specialty }}</span>
                      </td>
                      <td>
                        <div class="action-buttons">
                          <button
                            class="btn btn-sm btn-outline-primary me-2"
                            (click)="openEditModal(doctor)"
                            title="Edit Doctor">
                            <i class="fas fa-edit"></i> Edit
                          </button>
                          <button
                            class="btn btn-sm btn-outline-danger"
                            (click)="deleteDoctor(doctor)"
                            title="Delete Doctor">
                            <i class="fas fa-trash"></i> Delete
                          </button>
                        </div>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Create/Edit Doctor Modal -->
@if (showModal || showEditModal) {
  <div class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h5 class="modal-title">
          {{ modalMode === 'create' ? 'Add New Doctor' : 'Edit Doctor' }}
        </h5>
        <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Name *</label>
              <input
                type="text"
                class="form-control"
                [(ngModel)]="formData.name"
                name="name"
                placeholder="Dr. John Doe"
                required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Email *</label>
              <input
                type="email"
                class="form-control"
                [(ngModel)]="formData.email"
                name="email"
                placeholder="doctor@example.com"
                required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Specialty *</label>
              <input
                type="text"
                class="form-control"
                [(ngModel)]="formData.specialty"
                name="specialty"
                placeholder="Cardiology, Pediatrics, etc."
                required>
            </div>
            <div class="col-md-6">
              <label class="form-label">
                Password {{ modalMode === 'create' ? '*' : '(leave blank to keep current)' }}
              </label>
              <input
                type="password"
                class="form-control"
                [(ngModel)]="formData.password"
                name="password"
                [placeholder]="modalMode === 'create' ? 'Enter password' : 'Enter new password (optional)'"
                [required]="modalMode === 'create'">
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" (click)="closeModal()">Cancel</button>
        <button type="button" class="btn btn-primary" (click)="saveDoctor()">
          {{ modalMode === 'create' ? 'Create' : 'Update' }} Doctor
        </button>
      </div>
    </div>
  </div>
}

